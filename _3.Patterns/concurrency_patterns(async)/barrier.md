# Шаблон Barrier (Барьер)

## Описание
Barrier — это паттерн синхронизации, позволяющий группе потоков достигать определённой точки («барьера») и ждать друг друга перед продолжением выполнения.

## Проблема
В многопоточных алгоритмах часто требуется, чтобы несколько потоков выполнялись в «фазах»: ни один поток не должен начать следующий этап, пока все участники не завершили текущий. Без механизма барьера одни потоки могут опережать других, приводя к неконсистентности данных и неверному поведению.

## Решение
Barrier инкапсулирует логику ожидания: каждый поток вызывает `wait()` на барьере; когда последний из заданного числа потоков достигает барьера, все они одновременно освобождаются и продолжают работу.

## Структура
1. **Число участников** — сколько потоков должны встретиться на барьере  
2. **Текущий счётчик** — сколько потоков уже достигли барьера  
3. **Мьютекс** — защищает состояние барьера  
4. **Условная переменная** — позволяет потокам ждать и просыпаться после достижения барьера  

## Пример на Python
```python
import threading

barrier = threading.Barrier(3)

def worker(id):
    print(f"Поток {id} готов к барьеру")
    barrier.wait()
    print(f"Поток {id} прошёл барьер")

threads = [threading.Thread(target=worker, args=(i,)) for i in range(3)]
for t in threads:
    t.start()
for t in threads:
    t.join()
```

## Применение
- Научные вычисления (разбиение алгоритма на фазы)  
- Графические рендеры (фазы обработки)  
- Параллельные алгоритмы с синхронными шагами  
- Тестирование компонентов, требующих фазовой синхронизации  

## Плюсы
1. Гарантирует фазовую синхронизацию  
2. Простота использования стандартного API  
3. Инкапсулирует сложность ожидания в отдельном объекте  
4. Лёгкая настройка числа участников  

## Минусы
1. Потоки блокируются до наступления всех участников  
2. Не подходит для динамически меняющегося количества потоков  
3. Риск взаимоблокировки, если поток не достигнет барьера  

## Когда использовать
- Когда требуется согласованное начало этапов  
- Для реализации фазовых алгоритмов  
- При необходимости выравнивания выполнения потоков  

