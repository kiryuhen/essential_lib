# Шаблон Leader/Followers Pattern (Лидер/Последователи)

## Описание
Leader/Followers — это паттерн управления событиями, улучшающий масштабируемость Reactor за счёт циклической передачи роли лидера между потоками для демультиплексирования входящих событий.

## Проблема
В многопоточных системах несколько потоков могут конкурировать за один и тот же демультиплексор (select/epoll), что приводит к повышенным накладным расходам и контеншену.

## Решение
Один поток становится «лидером» и обрабатывает события, остальные — «последователями» — ждут сигнала о передаче лидерства. После обработки события лидер передаёт роль одному из followers, уменьшая конкуренцию за ресурс демультиплексирования.

## Структура
1. **Пул потоков (Thread Pool)** — группа потоков: один лидер и несколько последователей.  
2. **Лидер (Leader)** — поток, выполняющий вызов demux (select/epoll).  
3. **Последователи (Followers)** — потоки, ожидающие передачи лидерства.  
4. **Механизм передачи лидерства** — обычно условная переменная или очередь, через которую лидер передаёт управление следующему потоку.

## Пример на Python
```python
import threading, queue

events = queue.Queue()
lead_lock = threading.Lock()

# Функция обработки события
def handle(evt):
    print(f"Обрабатывается событие {evt} потоком {threading.current_thread().name}")

# Поток-работник
def worker():
    while True:
        # Этот поток — лидер демультиплексора
        with lead_lock:
            evt = events.get()
        handle(evt)

# Создание пула потоков
for i in range(3):
    t = threading.Thread(target=worker, name=f"Worker-{i}", daemon=True)
    t.start()

# Генерация событий
for i in range(10):
    events.put(i)
```

## Применение
- Высокопроизводительные сетевые серверы  
- Фреймворки с большим потоком I/O-событий  
- Системы с ограниченным доступом к демультиплексору  

## Плюсы
1. Снижает конкуренцию за ресурс демультиплексирования  
2. Улучшает масштабируемость на многопроцессорных системах  
3. Централизует обработку событий  

## Минусы
1. Сложность реализации и отладки  
2. Возможная задержка при передаче лидерства  
3. Требует аккуратной координации потоков  

## Когда использовать
- Для оптимизации Reactor в многопоточных серверах  
- При большом количестве одновременных I/O-событий  
- Когда важно равномерно распределить нагрузку между потоками  

