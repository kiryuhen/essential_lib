# Шаблон Balking Pattern (Отказ при неподготовленности)

## Описание
Balking — это паттерн, при котором метод сразу отказывается выполнять действие, если объект не находится в требуемом состоянии, вместо того чтобы блокировать поток.

## Проблема
Некоторые операции возможны лишь при определённом состоянии объекта (например, модуль логирования должен быть инициализирован перед использованием). Если вызвать метод в неподготовленном состоянии, прямое ожидание или блокировка нецелесообразны и могут привести к зависанию.

## Решение
Метод проверяет условие (guard) без ожидания: если условие не выполнено, метод логирует или возвращает без выполнения действия; иначе — выполняет операцию.

## Структура
1. **Состояние готовности (Ready Flag)** — булево поле или предикат, определяющее возможность выполнения.
2. **Метод (Operation)** — проверяет состояние и либо отказывается (balk), либо выполняет задачу.
3. **Синхронизация** — при необходимости защищает проверку состояния.

## Пример на Python
```python
import threading

class Service:
    def __init__(self):
        self._ready = False
        self._lock = threading.Lock()

    def initialize(self):
        with self._lock:
            self._ready = True

    def serve(self, request):
        with self._lock:
            if not self._ready:
                print("Сервис не готов — отказ")
                return None
        # Выполняем обработку
        print(f"Обрабатываем запрос: {request}")
        return f"Response to {request}"

# Использование
svc = Service()
print(svc.serve("req1"))  # отказ
svc.initialize()
print(svc.serve("req2"))  # работает
```

## Применение
- Ленивая инициализация модулей и сервисов
- Методы, требующие предварительной настройки
- Сценарии, где блокировка неприемлема или слишком дорогая

## Плюсы
1. Простота реализации и понимания
2. Нет блокировок при неподготовленности
3. Минимальные накладные расходы на проверку состояния

## Минусы
1. Клиенту приходится сам решать, что делать после отказа
2. Нет уведомлений о готовности — требуются опросы или внешние события
3. Не подходит, если требуется гарантированное выполнение

## Когда использовать
- Когда операция возможна лишь в одном состоянии объекта
- Для ленивой инициализации и простых сервисов
- Когда блокировка или ожидание недопустимы

